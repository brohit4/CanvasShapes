CanvasShapes={init:function(){var a;return a=function(b){var c,d,e=this;if(c=console,b=b||{},!a.validShapes.hasOwnProperty(b.type))return c&&c.error("Please pass a valid shape type. This is an invalid shape type--"+b.type),void 0;if(e.type=b.type,"number"!=typeof b.x||"number"!=typeof b.x||b.x<0||b.y<0)return c&&c.error("Co-ordinates missing for the created shape or onvalid co-ordinates"),void 0;if(e.x=b.x,e.y=b.y,d=a.defaultColor,e.fillStyle=b.fillStyle||d,"RECTANGLE"===b.type){if(!b.width||!b.height)return c&&c.error("Please pass in width and height for the rectangle"),void 0;e.width=b.width,e.height=b.height}if("CIRCLE"===b.type){if(!b.radius)return c&&c.error("Please pass in radius for the circle"),void 0;e.radius=b.radius}if("TEXT"===b.type){if(!b.text||!b.font)return c&&c.error("Please pass in the value of the text and the font size"),void 0;e.text=b.text,e.font=b.font}return e},a.shapes=[],a.defaultColor="#FBFBFB",a.shapeIndex=0,a.validShapes={RECTANGLE:!0,CIRCLE:!0,TEXT:!0},a.decrementDepth=function(a,b){var c,d,e,f=this;for(c=f.shapes,e=c.length,b=b||e,b>=e&&(b=e-1),d=a;b>=d;d++)c[d].index=c[d].index-1},a.prototype={paint:function(){var b=this;b.index=a.shapeIndex++,a.shapes&&a.shapes.push(b),b.draw()},draw:function(b){var c,d,e=this;a.canvas?c=a.canvas:(c=document.createElement("canvas"),c.id="ShapesConstructor",c.width=window.innerWidth-100,c.height=window.innerHeight,document.body.appendChild(c),a.canvas=c),d=c.getContext("2d"),b=b||{},d.fillStyle=b.fillStyle||e.fillStyle,"RECTANGLE"===e.type?d.fillRect(e.x,e.y,e.width,e.height):"CIRCLE"===e.type?(d.beginPath(),d.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),d.closePath(),d.fill()):"TEXT"===e.type&&(d.font=e.font,d.fillText(e.text,e.x,e.y))},move:function(b,c){var d=this;d.draw({fillStyle:"#FFF"}),d.redrawAffectedShapes(),b&&(d.x=b),c&&(d.y=c),d.draw(),a.decrementDepth(d.index+1),a.shapes.splice(d.index,1),d.index=a.shapes.length,a.shapes.push(d)},contains:function(a){var b,c,d,e=this;return b=e.getRectCoordinates(),c=a.getRectCoordinates(),d=function(a,b,c){return a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height?!0:!1},d(b.x,b.y,c)?!0:d(b.x+b.width,b.y,c)?!0:d(b.x+b.width,b.y+b.height,c)?!0:d(b.x,b.y+b.height,c)?!0:!1},containedShapes:function(b,c){var d,e,f,g=this,h=0,i=[];for(e=a.shapes,d=e.length,b=b||new Array(d);d>h;h++)(h!==g.index||c)&&(f=e[h],!b[f.index]&&g.index<=f.index&&(g.contains(f)||f.contains(g))&&(i.push(f),b[f.index]=!0));return i},affectedShapes:function(b){var c,d,e,f,g=this,h=0,i=[];for(d=a.shapes,c=d.length,f=new Array(c),i=g.containedShapes(f,b);i.length;)e=i.splice(0,1)[0],i=i.concat(e.containedShapes(f,b));for(;c>h;h++)considerElement=h===g.index?b:!0,f[h]&&considerElement&&i.push(d[h]);return i},bringToFront:function(b){var c,d,e,f=this;c=f.index,d=b.index,d>c?(e=a.shapes,a.decrementDepth(c+1,d),f.index=d,e.splice(c,1),e.splice(d,0,f),b.redrawAffectedShapes(!0)):console&&console.info("Shape already above")},modifyDimensions:function(a){var b,c,d,e=this;a=a||{},"RECTANGLE"===e.type?(b=a.width,"number"==typeof b&&b>=0&&(e.width=a.width),c=a.height,"number"==typeof c&&c>=0&&(e.height=a.height)):"CIRCLE"===e.type?(d=e.radius,"number"==typeof d&&d>=0&&(e.radius=a.radius)):"TEXT"===e.type&&(e.text=a.text||""),e.redrawAffectedShapes(!0)},moveToBackGround:function(b){var c,d,e,f=this;c=f.index,d=b.index,c>d?(e=a.shapes,a.decrementDepth(d+1,c),e.splice(d,1),e.splice(c,0,b),b.index=c,f.redrawAffectedShapes(!0)):console&&console.info("Shape already below")},redrawContainedShapes:function(){var a,b,c=this,d=0;for(a=c.containedShapes(),b=a.length;b>d;d++)a[d].draw()},redrawAffectedShapes:function(a){var b,c,d=this,e=0;for(b=d.affectedShapes(a),c=b.length;c>e;e++)b[e].draw()},getRectCoordinates:function(){var b,c,d,e,f,g=this;return"RECTANGLE"===g.type?b={x:g.x,y:g.y,width:g.width,height:g.height}:"CIRCLE"===g.type?b={x:g.x-g.radius,y:g.y-g.radius,width:2*g.radius,height:2*g.radius}:"TEXT"===g.type&&(c=a.canvas,d=c.getContext("2d"),e=d.measureText(g.text).width,f=g.font,b={x:g.x,y:g.y,width:e,height:Number(f.substr(0,f.length-2))}),b}},a}};